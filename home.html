<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="mainchatlok.css">
</head>
<body>
    <div id="logIn-page-container">
        <div id="username-container">
            <input type="text" autocomplete="on" id="user" placeholder="enter name"> <br>
            <input type="text" autocomplete="on" id="emaill" placeholder="enter email"><br>
            <input type="password" autocomplete="off" id="pass" placeholder="enter password"> <br>
            <div id="login-button-container">
                <button id="logIn">Log In</button>
            </div> <br> <center>
            <div id="result"> </div> </center>
        </div>
    </div>
    
</body>
<script type="module">
  
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
    import { getDatabase } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyBmuATPx4LbQAPWyIdbRcqpkgn8nsUB8hw",
      authDomain: "lok-db.firebaseapp.com",
      databaseURL: "https://lok-db-default-rtdb.firebaseio.com",
      projectId: "lok-db",
      storageBucket: "lok-db.appspot.com",
      messagingSenderId: "803437560630",
      appId: "1:803437560630:web:6ceeee89f0052d41dea997",
      measurementId: "G-GLVY4H3X97"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const auth = getAuth();
  
    //code from here
var btn = document.getElementById('logIn');
//event listener


firebase.auth().onAuthStateChanged(function(user) {
    if (user) {
      // User is already logged in, redirect to the appropriate page
      window.location.assign("home.html");
    }


    else {

  
btn.addEventListener("click", function() {
    var email = document.getElementById('emaill').value;
    var password = document.getElementById('pass').value;
    document.getElementById('result').innerHTML = "please wait...";
   
signInWithEmailAndPassword(auth, email, password)
  .then((userCredential) => {
    // Signed in 
    document.cookie = "firebaseAuth=" + userCredential.user.refreshToken + "; path=/";
    const user = userCredential.user;
    // ...
    var name = document.getElementById('user').value;
    var ema = document.getElementById('emaill').value;
    console.log("didi it");
    localStorage.setItem('textvalue',name);
    localStorage.setItem('email', ema);
    window.location.assign("home.html");
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    document.getElementById('result').innerHTML = "email address and password is incorrect";
  });
    
}); 
    }
  });
  
    </script>
</html>
